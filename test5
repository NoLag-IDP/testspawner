-- Escape Tsunami - Brainrot Spawner (WindUI)
local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/refs/heads/main/main_example.lua"))()

local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local StarterGui = game:GetService("StarterGui")

-- NOTIFICATION
local function notify(title, msg)
	StarterGui:SetCore("SendNotification", {
		Title = title;
		Text = msg;
		Duration = 4;
	})
end

-- SCAN BRAINROTS
-- Path: ReplicatedStorage > Assets > Brainrots > [Rarity] > [Brainrot]
local brainrotLookup = {}
local brainrotNames  = {}

local function scanBrainrots()
	brainrotLookup = {}
	brainrotNames  = {}

	local assetsFolder = ReplicatedStorage:WaitForChild("Assets", 5)
	if not assetsFolder then
		warn("[Spawner] ReplicatedStorage.Assets not found!")
		return
	end

	local brainrotsFolder = assetsFolder:WaitForChild("Brainrots", 5)
	if not brainrotsFolder then
		warn("[Spawner] ReplicatedStorage.Assets.Brainrots not found!")
		return
	end

	for _, rarityFolder in ipairs(brainrotsFolder:GetChildren()) do
		if rarityFolder:IsA("Folder") then
			for _, brainrot in ipairs(rarityFolder:GetChildren()) do
				local name = brainrot.Name
				if not brainrotLookup[name] then
					brainrotLookup[name] = { rarity = rarityFolder.Name, object = brainrot }
					table.insert(brainrotNames, name)
					print("[Spawner] Found: " .. name .. " (" .. rarityFolder.Name .. ")")
				end
			end
		end
	end

	table.sort(brainrotNames)
	print("[Spawner] Total: " .. #brainrotNames .. " brainrots")
end

scanBrainrots()

-- Fallback list if scan finds nothing
if #brainrotNames == 0 then
	warn("[Spawner] Scan found nothing, using fallback list")
	brainrotNames = {
		"Tralalero Tralala",
		"Bombardiro Crocodilo",
		"Tung Tung Tung Sahur",
		"Brr Brr Patapim",
		"Cappuccino Assassino",
		"Lirili Larila",
		"Glorbo Fruttodrillo",
		"Ballerina Cappuccina",
	}
	for _, n in ipairs(brainrotNames) do
		brainrotLookup[n] = { rarity = "Unknown", object = nil }
	end
end

-- SPAWN LOGIC
local function getOrCreateFolder()
	local f = Workspace:FindFirstChild("Brainrots")
	if not f then
		f = Instance.new("Folder")
		f.Name = "Brainrots"
		f.Parent = Workspace
	end
	return f
end

local function spawnBrainrot(name, level)
	if not name or name == "" then return false, "No brainrot selected!" end

	local lvl = tonumber(level)
	if not lvl or lvl < 1 then return false, "Level must be a number (min 1)!" end

	local entry = brainrotLookup[name]
	if not entry then return false, "Brainrot not found: " .. tostring(name) end

	local folder = getOrCreateFolder()
	local cloned = nil

	if entry.object then
		pcall(function() entry.object.Archivable = true end)
		for _, v in ipairs(entry.object:GetDescendants()) do
			pcall(function() v.Archivable = true end)
		end
		local ok, result = pcall(function() return entry.object:Clone() end)
		if ok and result then
			cloned = result
		end
	end

	-- Placeholder if clone failed or no real object
	if not cloned then
		cloned = Instance.new("Model")
		local part = Instance.new("Part")
		part.Name = "HumanoidRootPart"
		part.Size = Vector3.new(2, 2, 1)
		part.BrickColor = BrickColor.Random()
		part.Anchored = true
		part.Parent = cloned
		cloned.PrimaryPart = part
	end

	-- Position near player
	local spawnPos = Vector3.new(math.random(-20, 20), 5, math.random(-20, 20))
	local char = Players.LocalPlayer.Character
	if char and char.PrimaryPart then
		local cp = char.PrimaryPart.Position
		spawnPos = Vector3.new(
			cp.X + math.random(-8, 8),
			cp.Y + 2,
			cp.Z + math.random(-8, 8)
		)
	end

	pcall(function()
		if cloned:IsA("Model") and cloned.PrimaryPart then
			cloned:PivotTo(CFrame.new(spawnPos))
		elseif cloned:IsA("BasePart") then
			cloned.Position = spawnPos
		end
	end)

	cloned.Name = name
	cloned:SetAttribute("Level", lvl)
	cloned:SetAttribute("Rarity", entry.rarity)
	cloned.Parent = folder

	-- Billboard nametag
	local rootPart = nil
	if cloned:IsA("Model") then
		rootPart = cloned.PrimaryPart or cloned:FindFirstChildWhichIsA("BasePart")
	elseif cloned:IsA("BasePart") then
		rootPart = cloned
	end

	if rootPart then
		local existing = rootPart:FindFirstChildOfClass("BillboardGui")
		if existing then existing:Destroy() end

		local bb = Instance.new("BillboardGui")
		bb.Size = UDim2.new(0, 200, 0, 50)
		bb.StudsOffset = Vector3.new(0, 3.5, 0)
		bb.AlwaysOnTop = true
		bb.Parent = rootPart

		local nl = Instance.new("TextLabel")
		nl.Size = UDim2.new(1, 0, 0.55, 0)
		nl.BackgroundTransparency = 1
		nl.Text = name
		nl.Font = Enum.Font.GothamBold
		nl.TextSize = 14
		nl.TextColor3 = Color3.fromRGB(255, 255, 255)
		nl.TextStrokeTransparency = 0
		nl.Parent = bb

		local il = Instance.new("TextLabel")
		il.Size = UDim2.new(1, 0, 0.45, 0)
		il.Position = UDim2.new(0, 0, 0.55, 0)
		il.BackgroundTransparency = 1
		il.Text = "Lv." .. lvl .. "  |  " .. entry.rarity
		il.Font = Enum.Font.Gotham
		il.TextSize = 11
		il.TextColor3 = Color3.fromRGB(160, 210, 255)
		il.TextStrokeTransparency = 0
		il.Parent = bb
	end

	return true, "Spawned " .. name .. " (Lv." .. lvl .. ") [" .. entry.rarity .. "]"
end

-- WIND UI WINDOW
local window = library:CreateWindow({
	Title = "Brainrot Spawner",
	Size  = UDim2.fromOffset(400, 320),
})

-- State
local selectedBrainrot = brainrotNames[1] or ""
local levelValue = "1"

-- Dropdown
window:CreateDropdown({
	Title    = "Select Brainrot  (" .. #brainrotNames .. " found)",
	List     = brainrotNames,
	Default  = brainrotNames[1],
	Callback = function(val)
		selectedBrainrot = val
		local entry = brainrotLookup[val]
		if entry then
			print("[Spawner] Selected: " .. val .. " | Rarity: " .. entry.rarity)
		end
	end,
})

-- Level input
window:CreateInput({
	Title       = "Level",
	Placeholder = "e.g. 50",
	Callback    = function(val)
		levelValue = val
	end,
})

-- Spawn button
window:CreateButton({
	Title    = "Spawn Brainrot",
	Callback = function()
		if not selectedBrainrot or selectedBrainrot == "" then
			notify("No Brainrot", "Pick a brainrot from the dropdown!")
			return
		end
		if levelValue == "" or not tonumber(levelValue) then
			notify("Invalid Level", "Level must be a valid number!")
			return
		end
		local ok, msg = spawnBrainrot(selectedBrainrot, levelValue)
		if ok then
			notify("Spawned!", msg)
		else
			notify("Error", msg)
		end
	end,
})

-- Clear button
window:CreateButton({
	Title    = "Clear All Brainrots",
	Callback = function()
		local folder = Workspace:FindFirstChild("Brainrots")
		if folder then
			folder:ClearAllChildren()
			notify("Cleared", "All brainrots removed from Workspace!")
		else
			notify("Empty", "No Brainrots folder found.")
		end
	end,
})
